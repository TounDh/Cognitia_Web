{% extends 'base.html.twig' %}

{% block title %}{{ event.titre }}{% endblock %}

{% block body %}
<div class="container mt-4">
    <h1 class="mb-4">{{ event.titre }}</h1>

    {% if event.image %}
        <img src="{{ asset('uploads/events/' ~ event.image) }}" alt="Image de l'événement" class="img-fluid">
    {% else %}
        <p>Aucune image disponible pour cet événement.</p>
    {% endif %}

    <div class="mb-3">
        <h4>Description:</h4>
        <p>{{ event.description }}</p>
    </div>

    <div class="mb-3">
        <h4>Lieu:</h4>
        <p>{{ event.lieu }}</p>
    </div>

    <div class="mb-3">
        <h4>Type:</h4>
        <p>{{ event.type }}</p>
    </div>

    <div class="mb-3">
        <h4>Date de début:</h4>
        <p>{{ event.dateDebut|date('Y-m-d H:i') }}</p>
    </div>

    <div class="mb-3">
        <h4>Date de fin:</h4>
        <p>{{ event.dateFin|date('Y-m-d H:i') }}</p>
    </div>

    <hr>

    <h3>Commentaires</h3>

    <div class="mb-3">
        {% for commentaire in event.commentaires %}
            <div class="card p-3 mb-2">
                <h5>{{ commentaire.titre }}</h5>
                <p>{{ commentaire.contenu }}</p>
                <small>Publié le: {{ commentaire.dateActuelle|date('Y-m-d H:i') }}</small>
            </div>
        {% else %}
            <p>Aucun commentaire pour cet événement.</p>
        {% endfor %}
    </div>

    <h4>Ajouter un commentaire</h4>
    {{ form_start(commentaireForm) }}
        <div class="mb-3">
            {{ form_label(commentaireForm.titre) }}
            {{ form_widget(commentaireForm.titre, {'attr': {'class': 'form-control'}}) }}
            {{ form_errors(commentaireForm.titre) }}
        </div>

        <div class="mb-3">
            {{ form_label(commentaireForm.contenu) }}
            {{ form_widget(commentaireForm.contenu, {'attr': {'class': 'form-control'}}) }}
            {{ form_errors(commentaireForm.contenu) }}
        </div>

        <button type="submit" class="btn btn-primary">Publier le commentaire</button>
    {{ form_end(commentaireForm) }}

    <a href="{{ path('app_event_index') }}" class="btn btn-secondary mt-3">Retour à la liste des événements</a>
    {% if inviteLink %}
            <div class="mt-4">
                <h4>Join the Study Group:</h4>
                <a href="{{ inviteLink }}" target="_blank" class="btn btn-primary">Join Discord</a>
            </div>
        {% else %}
            <p>Failed to create an event channel on Discord.</p>
        {% endif %}
</div>
{% endblock %}