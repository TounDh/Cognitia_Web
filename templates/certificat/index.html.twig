{% extends 'base.html.twig' %}

{% block title %}Mes certificats{% endblock %}

{% block body %}
<div class="container my-5">
  <h1 class="text-center mb-4" style="margin-top: 110px;">Mes certificats</h1>
  
  {% if certificats is empty %}
    <div class="alert alert-info text-center">
      <i class="fas fa-info-circle fa-2x mb-3"></i>
      <p class="h5">Vous n'avez pas encore obtenu de certificat.</p>
    </div>
  {% else %}
    <div class="table-responsive">
      <table class="table table-striped table-hover shadow">
        <thead class="thead-dark">
          <tr>
            <th>Quiz</th>
            <th>Apprenant</th>
            <th>Score</th>
            <th>Date d'obtention</th>
            {% if is_granted('ROLE_APPRENANT') %}
            <th>Actions</th>
            {% endif %}
          </tr>
        </thead>
        <tbody>
          {% for certificat in certificats %}
            <tr class="align-middle">
              <td>
                <div class="d-flex align-items-center">
                  <i class="fas fa-certificate text-primary me-3 fa-lg"></i>
                  <span>{{ certificat.quiz.titre }}</span>
                </div>
              </td>
              <td>
                <div class="d-flex align-items-center">
                  <i class="fas fa-user text-primary me-3 fa-lg"></i>
                  <span>{{ certificat.apprenant.firstName }}</span>
                </div>
              </td>
              <td>
                <span class="badge bg-{{ certificat.score >= 80 ? 'success' : 'warning' }} rounded-pill p-2">
                  {{ certificat.score }}%
                </span>
              </td>
              <td>{{ certificat.dateObtention ? certificat.dateObtention|date('d/m/Y') : '' }}</td>
              {% if is_granted('ROLE_APPRENANT') %}
              <td>
                <a href="{{ path('app_generate_certificate', {'id': certificat.id}) }}" class="btn btn-primary btn-sm">
                  <i class="fas fa-download mr-1"></i>Télécharger
                </a>
              </td>
              {% endif %}
            </tr>
          {% else %}
            <tr>
              <td colspan="5" class="text-center">Aucun certificat trouvé</td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  {% endif %}
</div>

<style>
  .table-hover tbody tr:hover {
    transform: scale(1.02);
    transition: transform 0.2s ease-in-out;
  }
  
  @media (max-width: 768px) {
    .table thead {
      display: none;
    }
    
    .table, .table tbody, .table tr, .table td {
      display: block;
      width: 100%;
    }
    
    .table tr {
      margin-bottom: 1rem;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    
    .table td {
      text-align: right;
      padding-left: 50%;
      position: relative;
    }
    
    .table td::before {
      content: attr(data-label);
      position: absolute;
      left: 0;
      width: 50%;
      padding-left: 1rem;
      text-align: left;
      font-weight: bold;
    }
  }
</style>

<script>
  // Ajouter des labels pour la version mobile
  document.querySelectorAll('td').forEach((td, index) => {
    const headers = ['Quiz', 'Score', 'Date d\'obtention', 'Actions'];
    td.setAttribute('data-label', headers[index % headers.length]);
  });
</script>
{% endblock %}
